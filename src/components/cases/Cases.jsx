import React, { useCallback, useEffect, useState } from 'react';
import useEmblaCarousel from "embla-carousel-react";
import CasesSlides from "../casesSlides/CasesSlides";
import { casesSlides } from "../helpers/casesSlides";
import './cases.scss';


const Cases = ({ props }) => {

    const [emblaRef, emblaApi] = useEmblaCarousel({ loop: false });
    const [selectedIndex, setSelectedIndex] = useState(0);
    const [scrollSnaps, setScrollSnaps] = useState([]);

    useEffect(() => {
        if (!emblaApi) return;
        setScrollSnaps(emblaApi.scrollSnapList());
        emblaApi.on("select", () => setSelectedIndex(emblaApi.selectedScrollSnap()));
    }, [emblaApi]);

    const scrollPrev = useCallback(() => emblaApi && emblaApi.scrollPrev(), [emblaApi]);
    const scrollNext = useCallback(() => emblaApi && emblaApi.scrollNext(), [emblaApi]);

    return (
        <section className="section cases">
            <div className="container">
                <div className="cases_inner">
                    <h2 className="project_title">Наши кейсы</h2>
                    <svg className="cases_eye" width="79" height="60" viewBox="0 0 79 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fillRule="evenodd" clipRule="evenodd" d="M10.2348 44.2145C12.2315 40.0326 14.8836 36.975 17.5721 33.9753C21.4117 29.6932 26.1854 26.5363 31.0699 23.6339C38.1052 19.4525 45.8148 18.3912 53.8842 19.376C60.0971 20.1364 65.7569 22.2723 71.0467 25.8265C69.1086 30.7469 65.9727 34.7591 62.2626 38.4431C56.9253 43.747 50.0104 45.8244 43.1738 48.041C38.2083 49.65 33.049 50.2501 27.8362 49.786C23.524 49.3993 19.4512 47.9778 15.4488 46.3773C13.769 45.7046 12.1053 44.9922 10.2348 44.2145ZM51.9779 31.4318C50.6617 27.3457 48.2088 24.4905 43.8242 23.419C40.5096 22.6104 37.3664 23.0663 34.3007 24.2379C28.8444 26.3221 26.7979 31.6248 27.7895 36.5569C28.7536 41.3475 34.3627 47.139 40.3758 46.2224C44.0684 45.6604 46.9199 43.8878 49.7501 41.8972C50.9863 41.0291 51.7961 39.6145 52.1133 37.9657C52.5353 35.7648 52.5993 33.6187 51.9779 31.4318Z" fill="white" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M39.1836 32.2205C40.4805 31.8279 42.1239 32.5603 42.3685 33.6384C42.6125 34.7111 41.6862 36.2375 40.6241 36.506C39.0445 36.9067 37.7344 36.2049 37.3312 34.7451C36.9721 33.4409 37.4927 32.7315 39.1836 32.2205Z" fill="white" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M15.1344 32.5042C17.4353 30.4099 19.4909 28.5384 21.6966 26.5332C20.0182 24.6311 18.4712 22.8644 16.905 21.1134C16.6131 20.79 16.0929 20.5937 15.9508 20.2318C15.7562 19.731 15.5824 18.9469 15.8335 18.6197C16.098 18.2792 17.0257 18.0676 17.402 18.2734C18.2246 18.7243 18.9299 19.4279 19.5979 20.1125C21.1729 21.7252 22.3021 23.8187 24.5924 24.7576C26.7587 23.2902 28.9158 21.8277 31.2135 20.2711C30.8207 16.979 29.0015 13.8422 29.0836 10.1685C31.7092 10.5805 31.8016 12.5051 32.3099 14.1018C32.8126 15.6775 33.2943 17.2619 33.8473 19.0406C36.9525 18.2086 39.8474 17.4329 43.0652 16.5707C42.5045 13.763 41.9774 11.117 41.393 8.18535C41.9152 7.93518 42.5546 7.63023 43.5461 7.15529C44.4397 10.4903 45.2458 13.4986 46.0237 16.4017C48.9768 16.462 51.5803 16.5153 54.4016 16.5731C54.4507 14.2604 54.475 12.092 54.5509 9.92433C54.5895 8.82178 54.7423 7.74579 56.4801 8.11881C57.5642 10.9963 56.8226 14.1158 57.2207 17.1876C59.6091 17.7597 61.879 18.3041 64.3674 18.901C64.6697 17.6143 64.9569 16.3582 65.2642 15.108C65.4321 14.428 65.5205 13.6912 65.8532 13.1006C66.1112 12.6459 66.6985 12.3807 67.1385 12.031C67.4562 12.5769 68.0896 13.1565 68.0363 13.6634C67.8006 15.9109 67.3704 18.1382 66.9923 20.473C68.3869 21.2318 69.6454 21.8467 70.8259 22.5847C71.6354 23.0914 72.3304 23.7809 73.0895 24.3703C74.0019 25.0779 74.0694 25.8374 73.5809 26.9011C71.2024 32.0698 67.9705 36.5472 63.8309 40.5024C59.6242 44.5199 54.4751 46.5491 49.2658 48.6661C44.5805 50.5694 39.7481 51.7081 34.7439 52.2023C27.7418 52.8913 21.149 51.2927 14.745 48.6173C12.8821 47.8407 10.9886 47.1392 9.09954 46.43C7.01195 45.6469 6.54477 44.2758 7.84268 42.4423C9.35757 40.3011 10.9303 38.2015 12.4704 36.0793C12.6732 35.8028 12.8338 35.4982 13.1683 34.9562C11.3735 33.788 9.63854 32.6657 7.90955 31.5297C6.47289 30.5866 6.4552 30.3644 7.65507 28.5885C10.4974 29.2265 12.1258 32.3091 15.1344 32.5042ZM10.2347 44.2143C12.1051 44.992 13.7689 45.7044 15.4484 46.3764C19.4501 47.9771 23.5237 49.3984 27.8359 49.785C33.0477 50.2486 38.2078 49.6483 43.1735 48.0401C50.0099 45.8227 56.9255 43.7451 62.2623 38.4421C65.9723 34.7582 69.1083 30.7459 71.0464 25.8256C65.7566 22.2713 60.0967 20.1354 53.8839 19.3751C45.8152 18.3901 38.1051 19.4523 31.0696 23.633C26.1851 26.5354 21.4114 29.6922 17.5718 33.9743C14.8835 36.9748 12.2314 40.0324 10.2347 44.2143Z" fill="#283034" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M51.9778 31.4316C52.5992 33.6185 52.5351 35.7645 52.1124 37.9656C51.795 39.6137 50.9855 41.0291 49.7492 41.8972C46.919 43.8877 44.0682 45.6601 40.3749 46.2224C34.3618 47.139 28.7525 41.3467 27.7886 36.5568C26.797 31.6247 28.8442 26.3218 34.2998 24.2378C37.3657 23.067 40.5095 22.6102 43.8233 23.4189C48.2087 24.4902 50.6623 27.3452 51.9778 31.4316ZM49.9487 32.7592C49.0846 29.2191 46.9943 26.9751 43.3788 26.0106C41.4655 25.4994 39.7619 25.9841 37.9511 26.252C31.9705 27.1365 29.481 30.3172 30.3273 36.1462C30.8814 39.9682 35.1163 43.4847 38.9693 43.6202C42.0875 43.7288 44.5421 42.259 46.995 40.7501C49.5909 39.1556 50.7693 35.7467 49.9487 32.7592Z" fill="#283034" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M44.4911 32.2611C45.3044 35.612 44.0104 38.3612 41.296 39.0386C38.5056 39.7356 35.3567 37.9386 34.7112 35.28C34.0517 32.5697 35.6196 30.2388 38.705 29.5731C42.3939 28.7778 44.0008 29.8636 44.4911 32.2611Z" fill="#283034" />
                    </svg>
                    <div id="cases_wrapper" className="grid-row">
                        <div className="button-wrapper">
                            <button className="slider-arrow prev project_arrow" onClick={scrollPrev}>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21.7664 12.0003C21.7665 12.1504 21.7369 12.2989 21.6796 12.4375C21.6222 12.5761 21.538 12.7021 21.4319 12.8082C21.3259 12.9142 21.1999 12.9984 21.0613 13.0558C20.9227 13.1132 20.7741 13.1427 20.6241 13.1426L2.32164 13.1426C2.17003 13.1453 2.01941 13.1178 1.87855 13.0616C1.73769 13.0055 1.60942 12.9219 1.50123 12.8157C1.39303 12.7094 1.30708 12.5827 1.24838 12.4429C1.18967 12.3031 1.15941 12.153 1.15933 12.0014C1.15926 11.8497 1.18939 11.6996 1.24796 11.5598C1.30652 11.4199 1.39236 11.2931 1.50046 11.1868C1.60855 11.0804 1.73674 10.9967 1.87754 10.9404C2.01835 10.8842 2.16895 10.8565 2.32055 10.8591L20.623 10.8591C20.9256 10.8593 21.2158 10.9796 21.4298 11.1936C21.6438 11.4076 21.7641 11.6977 21.7643 12.0003L21.7664 12.0003Z" fill="white" />
                                    <path d="M12.8175 22.497C12.6033 22.7111 12.3129 22.8314 12.01 22.8314C11.7071 22.8314 11.4167 22.7111 11.2025 22.497L1.51297 12.8074C1.29882 12.5933 1.1785 12.3028 1.1785 11.9999C1.1785 11.6971 1.29881 11.4066 1.51296 11.1925L11.2025 1.50296C11.4166 1.28881 11.7071 1.1685 12.01 1.1685C12.3128 1.1685 12.6033 1.28881 12.8174 1.50296C13.0316 1.71712 13.1519 2.00757 13.1519 2.31043C13.1519 2.61328 13.0316 2.90374 12.8174 3.11789L3.93535 12L12.8175 20.8821C13.0316 21.0962 13.1519 21.3867 13.1519 21.6895C13.1519 21.9924 13.0316 22.2828 12.8175 22.497Z" fill="white" />
                                </svg>
                            </button>
                        </div>
                        <div className="swiper-cases embla" ref={emblaRef}>
                            <div className="embla__container">
                                {casesSlides.map((slide, index) => {
                                    return (
                                        <div className="embla__slide" key={index}>
                                            <CasesSlides {...slide} />
                                        </div>
                                    )
                                })}
                            </div>
                        </div>
                        <div className="button-wrapper">
                            <button className="slider-arrow next project_arrow" onClick={scrollNext}>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2.23353 12.0003C2.23348 12.1504 2.263 12.2989 2.32038 12.4375C2.37777 12.5761 2.46191 12.7021 2.56799 12.8082C2.67407 12.9142 2.80002 12.9984 2.93863 13.0558C3.07724 13.1132 3.2258 13.1427 3.37582 13.1426L21.6783 13.1426C21.8299 13.1453 21.9805 13.1178 22.1214 13.0616C22.2622 13.0055 22.3905 12.9219 22.4987 12.8157C22.6069 12.7094 22.6929 12.5827 22.7516 12.4429C22.8103 12.3031 22.8405 12.153 22.8406 12.0014C22.8407 11.8497 22.8106 11.6996 22.752 11.5598C22.6934 11.4199 22.6076 11.2931 22.4995 11.1868C22.3914 11.0804 22.2632 10.9967 22.1224 10.9404C21.9816 10.8842 21.831 10.8565 21.6794 10.8591L3.3769 10.8591C3.07429 10.8593 2.78413 10.9796 2.57015 11.1936C2.35617 11.4076 2.23587 11.6977 2.23568 12.0003L2.23353 12.0003Z" fill="white" />
                                    <path d="M11.1825 22.497C11.3967 22.7111 11.6871 22.8314 11.99 22.8314C12.2929 22.8314 12.5833 22.7111 12.7975 22.497L22.487 12.8074C22.7012 12.5933 22.8215 12.3028 22.8215 11.9999C22.8215 11.6971 22.7012 11.4066 22.487 11.1925L12.7975 1.50296C12.5834 1.28881 12.2929 1.1685 11.99 1.1685C11.6872 1.1685 11.3967 1.28881 11.1826 1.50296C10.9684 1.71712 10.8481 2.00757 10.8481 2.31043C10.8481 2.61328 10.9684 2.90374 11.1826 3.11789L20.0646 12L11.1825 20.8821C10.9684 21.0962 10.8481 21.3867 10.8481 21.6895C10.8481 21.9924 10.9684 22.2828 11.1825 22.497Z" fill="white" />
                                </svg>
                            </button>
                        </div>
                        {/* Индикаторы (точки) */}
                        <div className="slider_dots">
                            {scrollSnaps.map((_, index) => (
                                <button
                                    key={index}
                                    className={`dot ${index === selectedIndex ? "active" : ""}`}
                                    onClick={() => emblaApi && emblaApi.scrollTo(index)}
                                />
                            ))}
                        </div>
                    </div>

                </div>
            </div>
        </section>
    );
}

export default Cases;